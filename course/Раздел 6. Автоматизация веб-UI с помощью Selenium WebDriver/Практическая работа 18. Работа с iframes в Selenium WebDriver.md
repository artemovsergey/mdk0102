# Практическая работа 18. Работа с iframes в Selenium WebDriver

## Цель работы

* Научиться работать с **iframe** и **frames** в веб-приложениях.
* Освоить методы переключения между основным окном и iframe: `SwitchTo().Frame()` и `SwitchTo().DefaultContent()`.
* Научиться взаимодействовать с элементами внутри iframe и проверять их свойства.

---

## Теоретическая часть

### Что такое iframe

* **iframe** (inline frame) — это встроенный фрейм внутри веб-страницы, который позволяет отображать отдельный HTML-документ внутри основной страницы.
* Элементы внутри iframe **не видны** WebDriver, пока не выполнено переключение на этот фрейм.

### Методы работы с iframe

1. **Переключение на iframe**

   ```csharp
   driver.SwitchTo().Frame("frameName"); // по имени или ID
   driver.SwitchTo().Frame(0);           // по индексу
   driver.SwitchTo().Frame(iframeElement);// по веб-элементу
   ```
2. **Возврат к основному контенту**

   ```csharp
   driver.SwitchTo().DefaultContent();
   ```
3. **Переключение между фреймами**

   * Сначала вернуться в `DefaultContent()`, затем снова выбрать другой фрейм.

### Особенности

* Элементы внутри iframe доступны только после переключения на него.
* Если на странице несколько iframe, нужно точно указать нужный.
* Можно использовать Nested iframes (вложенные фреймы), переключаясь последовательно.

---

## Ход работы

### Шаг 1. Подготовка проекта

1. Создать **xUnit Test Project (.NET)**.
2. Установить через NuGet:

   * `Selenium.WebDriver`
   * `Selenium.WebDriver.ChromeDriver`
   * `Selenium.Support`

---

### Шаг 2. Настройка WebDriver

```csharp
using OpenQA.Selenium;
using OpenQA.Selenium.Chrome;
using Xunit;

namespace IframeTests
{
    public class IframeHandlingTests : IDisposable
    {
        private IWebDriver _driver;

        public IframeHandlingTests()
        {
            _driver = new ChromeDriver();
            _driver.Manage().Window.Maximize();
            _driver.Navigate().GoToUrl("https://example.com/iframe");
        }

        public void Dispose()
        {
            _driver.Quit();
        }
    }
}
```

---

### Шаг 3. Переключение на iframe по имени или ID

```csharp
[Fact]
public void SwitchToIframeByNameTest()
{
    // Переключение на iframe
    _driver.SwitchTo().Frame("frame1");

    // Взаимодействие с элементом внутри iframe
    IWebElement insideFrame = _driver.FindElement(By.Id("inputField"));
    insideFrame.SendKeys("Hello iframe");

    // Возврат к основному контенту
    _driver.SwitchTo().DefaultContent();

    IWebElement mainPageButton = _driver.FindElement(By.Id("mainButton"));
    Assert.True(mainPageButton.Displayed);
}
```

---

### Шаг 4. Переключение на iframe по индексу

```csharp
[Fact]
public void SwitchToIframeByIndexTest()
{
    _driver.SwitchTo().Frame(0); // Первый iframe на странице

    IWebElement insideFrame = _driver.FindElement(By.Id("inputField"));
    insideFrame.SendKeys("Testing index iframe");

    _driver.SwitchTo().DefaultContent();
}
```

---

### Шаг 5. Переключение на iframe по веб-элементу

```csharp
[Fact]
public void SwitchToIframeByElementTest()
{
    IWebElement iframeElement = _driver.FindElement(By.TagName("iframe"));
    _driver.SwitchTo().Frame(iframeElement);

    IWebElement insideFrame = _driver.FindElement(By.Id("inputField"));
    insideFrame.SendKeys("Testing element iframe");

    _driver.SwitchTo().DefaultContent();
}
```

---

### Шаг 6. Работа с вложенными iframes

```csharp
[Fact]
public void NestedIframeTest()
{
    _driver.SwitchTo().Frame("outerFrame");
    _driver.SwitchTo().Frame("innerFrame");

    IWebElement nestedInput = _driver.FindElement(By.Id("nestedInput"));
    nestedInput.SendKeys("Nested iframe test");

    _driver.SwitchTo().DefaultContent();
}
```

---

## Практический пример

**Сценарий:**

1. Открыть страницу с iframe.
2. Переключиться на iframe по имени, индексу или элементу.
3. Ввести текст или нажать кнопку внутри iframe.
4. Вернуться к основному контенту и проверить элемент на главной странице.
5. Повторить для вложенных iframe.

---

## Варианты заданий (по номеру в журнале)

1. Ввести текст в поле внутри iframe по имени
2. Ввести текст в поле внутри iframe по индексу
3. Ввести текст в поле внутри iframe по веб-элементу
4. Проверить кнопку на главной странице после работы с iframe
5. Создать тест для двух iframe на странице
6. Использовать вложенные iframe и взаимодействовать с элементами
7. Проверить наличие текста внутри iframe
8. Ввести текст и нажать кнопку внутри iframe, затем проверить результат
9. Использовать переключение между iframe и основным контентом несколько раз
10. Создать Page Object класс для работы с iframe
11. Проверить элементы формы внутри iframe
12. Проверить элемент изображения внутри iframe
13. Создать тест для нескольких вложенных iframe
14. Проверить текст на странице после действий внутри iframe
15. Комбинированный тест: ввод текста, нажатие кнопки, проверка результата внутри iframe и основного контента

---

## Критерии оценки

| Оценка | Критерии                                                                                               |
| ------ | ------------------------------------------------------------------------------------------------------ |
| 2      | Тест создан, но не обрабатывает iframe корректно                                                       |
| 3      | Используется один способ переключения на iframe                                                        |
| 4      | Используются несколько способов переключения, тесты проходят стабильно                                 |
| 5      | Все способы переключения реализованы, есть работа с вложенными iframe, Page Object, скриншоты и readme |

---

## Контрольные вопросы

1. Что такое iframe и зачем он используется на страницах?
2. Как переключиться на iframe по имени, индексу и веб-элементу?
3. Как вернуться к основному контенту после работы с iframe?
4. Как работать с вложенными iframe?
5. Какие ошибки могут возникнуть при работе с iframe и как их избежать?
6. Почему элементы внутри iframe недоступны без переключения?
7. Как комбинировать работу с iframe и основным контентом в одном тесте?

---

## Структура репозитория

```
IframeTests/
│
├─ Drivers/          # Инициализация WebDriver
├─ Pages/            # Page классы (IframePage.cs)
├─ Tests/            # Тестовые классы (IframeHandlingTests.cs)
├─ images/           # Скриншоты работы тестов
└─ readme.md         # Описание работы, вариант, текст задания
```

### Пример `readme.md`

````markdown
# Практическая работа №18
## Тема: Работа с iframes в Selenium WebDriver
### Вариант: 4

**Задание:** Переключиться на iframe, ввести текст в поле внутри него, затем вернуться к основному контенту и проверить кнопку на главной странице.

**Пример кода:**
```csharp
_driver.SwitchTo().Frame("frame1");
_driver.FindElement(By.Id("inputField")).SendKeys("Hello iframe");
_driver.SwitchTo().DefaultContent();
Assert.True(_driver.FindElement(By.Id("mainButton")).Displayed);
````

```
