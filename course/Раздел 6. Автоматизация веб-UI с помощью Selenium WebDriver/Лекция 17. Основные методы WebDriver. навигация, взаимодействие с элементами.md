# Лекция 17. Основные методы WebDriver. Навигация, взаимодействие с элементами

## Цель лекции

Научить студентов использовать ключевые методы Selenium WebDriver для навигации по страницам и взаимодействия с веб-элементами. Рассмотреть практические сценарии автоматизации тестирования.

---

## План лекции

1. Введение в WebDriver
2. Навигация по страницам
3. Взаимодействие с элементами

   * Ввод текста
   * Клики
   * Работа с чекбоксами и радиокнопками
   * Работа с выпадающими списками
   * Получение текста и атрибутов
4. Ожидания элементов
5. Примеры автоматизации
6. Резюме
7. Контрольные вопросы

---

## 1. Введение в WebDriver

**WebDriver** — это интерфейс для автоматизации браузеров. Он позволяет:

* Открывать страницы
* Навигировать по истории
* Искать элементы на странице
* Взаимодействовать с элементами
* Управлять окнами и вкладками браузера

Пример инициализации WebDriver на C#:

```csharp
using OpenQA.Selenium;
using OpenQA.Selenium.Chrome;

IWebDriver driver = new ChromeDriver();
driver.Navigate().GoToUrl("https://example.com");
```

---

## 2. Навигация по страницам

WebDriver предоставляет методы для навигации:

| Метод                     | Описание                         | Пример                                             |
| ------------------------- | -------------------------------- | -------------------------------------------------- |
| `Navigate().GoToUrl(url)` | Перейти на указанный URL         | `driver.Navigate().GoToUrl("https://google.com");` |
| `Navigate().Back()`       | Вернуться на предыдущую страницу | `driver.Navigate().Back();`                        |
| `Navigate().Forward()`    | Перейти вперед по истории        | `driver.Navigate().Forward();`                     |
| `Navigate().Refresh()`    | Обновить текущую страницу        | `driver.Navigate().Refresh();`                     |

Пример кода:

```csharp
driver.Navigate().GoToUrl("https://example.com/page1");
driver.Navigate().GoToUrl("https://example.com/page2");
driver.Navigate().Back();     // Вернуться на page1
driver.Navigate().Forward();  // Вернуться на page2
driver.Navigate().Refresh();  // Обновить page2
```

---

## 3. Взаимодействие с элементами

### 3.1 Ввод текста

```csharp
IWebElement username = driver.FindElement(By.Id("username"));
username.SendKeys("testuser");
```

### 3.2 Клик по элементу

```csharp
IWebElement loginButton = driver.FindElement(By.Id("loginBtn"));
loginButton.Click();
```

### 3.3 Работа с чекбоксами и радиокнопками

```csharp
IWebElement checkbox = driver.FindElement(By.Id("acceptTerms"));
if (!checkbox.Selected) {
    checkbox.Click(); // Отметить чекбокс
}

IWebElement radio = driver.FindElement(By.Id("genderMale"));
radio.Click(); // Выбрать радиокнопку
```

### 3.4 Работа с выпадающими списками

Для `<select>` элементов удобно использовать `SelectElement`:

```csharp
using OpenQA.Selenium.Support.UI;

IWebElement countrySelect = driver.FindElement(By.Id("country"));
SelectElement select = new SelectElement(countrySelect);
select.SelectByText("Russia");   // По видимому тексту
select.SelectByValue("RU");      // По значению атрибута value
select.SelectByIndex(3);         // По индексу элемента
```

### 3.5 Получение текста и атрибутов

```csharp
IWebElement welcomeText = driver.FindElement(By.Id("welcome"));
string text = welcomeText.Text;                 // Получить текст элемента
string value = welcomeText.GetAttribute("value"); // Получить значение атрибута
```

---

## 4. Ожидания элементов

Для надежной автоматизации важно **ждать появления элементов**:

```csharp
using OpenQA.Selenium.Support.UI;

WebDriverWait wait = new WebDriverWait(driver, TimeSpan.FromSeconds(10));
IWebElement element = wait.Until(d => d.FindElement(By.Id("username")));
```

* **Implicit Wait** – глобальное ожидание для всех элементов:

```csharp
driver.Manage().Timeouts().ImplicitWait = TimeSpan.FromSeconds(10);
```

* **Explicit Wait** – ожидание конкретного элемента (рекомендовано):

```csharp
WebDriverWait wait = new WebDriverWait(driver, TimeSpan.FromSeconds(10));
IWebElement loginButton = wait.Until(SeleniumExtras.WaitHelpers.ExpectedConditions.ElementToBeClickable(By.Id("loginBtn")));
```

---

## 5. Примеры автоматизации

### Пример 1: Вход на сайт

```csharp
IWebDriver driver = new ChromeDriver();
driver.Navigate().GoToUrl("https://example.com/login");

// Ввод данных
driver.FindElement(By.Id("username")).SendKeys("testuser");
driver.FindElement(By.Id("password")).SendKeys("password123");

// Клик по кнопке
driver.FindElement(By.Id("loginBtn")).Click();

driver.Quit();
```

### Пример 2: Работа с чекбоксом и выпадающим списком

```csharp
IWebDriver driver = new ChromeDriver();
driver.Navigate().GoToUrl("https://example.com/form");

// Отметить чекбокс
IWebElement checkbox = driver.FindElement(By.Id("subscribe"));
if (!checkbox.Selected) checkbox.Click();

// Выбрать страну
SelectElement countrySelect = new SelectElement(driver.FindElement(By.Id("country")));
countrySelect.SelectByText("Russia");

driver.Quit();
```

---

## 6. Резюме

* WebDriver предоставляет методы для **навигации и взаимодействия с элементами**.
* Навигация: `GoToUrl`, `Back`, `Forward`, `Refresh`.
* Взаимодействие с элементами: `SendKeys`, `Click`, работа с чекбоксами, радиокнопками, выпадающими списками.
* Получение данных с элементов: `Text`, `GetAttribute`.
* Для стабильных тестов используем ожидания элементов (Implicit или Explicit Wait).

---

## 7. Контрольные вопросы

1. Какие методы WebDriver используются для навигации по страницам?
2. Как вводить текст в поле ввода?
3. Как проверить, выбран ли чекбокс, и отметить его при необходимости?
4. Как выбрать элемент из выпадающего списка по тексту и по значению?
5. В чем разница между `Implicit Wait` и `Explicit Wait`?
6. Как получить текст элемента и значение его атрибута?
7. Почему важно использовать ожидания при автоматизации веб-приложений?
