# Лекция 19. Паттерн Page Object Model (POM) для поддержки тестов

## Цель лекции

Познакомить студентов с паттерном **Page Object Model (POM)** в автоматизации тестирования с использованием Selenium WebDriver на .NET. Показать, как POM помогает сделать тесты **поддерживаемыми, читаемыми и структурированными**.

---

## План лекции

1. Введение в Page Object Model (POM)
2. Зачем использовать POM
3. Структура проекта с POM
4. Создание Page классов
5. Создание тестов с использованием POM
6. Примеры на C#
7. Резюме
8. Контрольные вопросы

---

## 1. Введение в Page Object Model (POM)

**Page Object Model** — это паттерн проектирования тестов, при котором каждая веб-страница представлена отдельным классом.

**Идея POM:**

* Разделить **структуру страниц** и **тестовую логику**
* Создать удобный интерфейс для взаимодействия с элементами страницы

**Структура:**

```
Page Classes (HomePage, LoginPage, ProfilePage)
          ↑
          │
    Тестовые классы (LoginTests, ProfileTests)
```

---

## 2. Зачем использовать POM

**Проблемы без POM:**

* Дублирование кода поиска элементов
* Сложность поддержки при изменении UI
* Невозможность повторного использования методов

**Преимущества POM:**

* Поддерживаемость: изменения в странице отражаются только в одном классе
* Повторное использование: методы взаимодействия можно использовать в разных тестах
* Читаемость: тесты становятся лаконичными и понятными

---

## 3. Структура проекта с POM

Пример структуры .NET проекта:

```
/Pages
   LoginPage.cs
   HomePage.cs
/Tests
   LoginTests.cs
   ProfileTests.cs
/Drivers
   WebDriverFactory.cs
/Utils
   WaitHelpers.cs
```

* **Pages** – классы страниц с локаторами и методами взаимодействия
* **Tests** – тестовые классы с логикой проверки
* **Drivers** – инициализация WebDriver
* **Utils** – вспомогательные методы (ожидания, скриншоты)

---

## 4. Создание Page классов

### Пример: LoginPage.cs

```csharp
using OpenQA.Selenium;
using OpenQA.Selenium.Support.UI;
using SeleniumExtras.WaitHelpers;

public class LoginPage
{
    private IWebDriver _driver;
    private WebDriverWait _wait;

    public LoginPage(IWebDriver driver)
    {
        _driver = driver;
        _wait = new WebDriverWait(driver, TimeSpan.FromSeconds(10));
    }

    // Локаторы
    private IWebElement UsernameField => _driver.FindElement(By.Id("username"));
    private IWebElement PasswordField => _driver.FindElement(By.Id("password"));
    private IWebElement LoginButton => _driver.FindElement(By.Id("loginBtn"));

    // Методы взаимодействия
    public void EnterUsername(string username)
    {
        UsernameField.SendKeys(username);
    }

    public void EnterPassword(string password)
    {
        PasswordField.SendKeys(password);
    }

    public void ClickLogin()
    {
        LoginButton.Click();
    }

    // Метод для логина в один шаг
    public void LoginAs(string username, string password)
    {
        EnterUsername(username);
        EnterPassword(password);
        ClickLogin();
    }
}
```

---

## 5. Создание тестов с использованием POM

### Пример: LoginTests.cs

```csharp
using OpenQA.Selenium;
using OpenQA.Selenium.Chrome;
using NUnit.Framework;

[TestFixture]
public class LoginTests
{
    private IWebDriver _driver;
    private LoginPage _loginPage;

    [SetUp]
    public void Setup()
    {
        _driver = new ChromeDriver();
        _driver.Navigate().GoToUrl("https://example.com/login");
        _loginPage = new LoginPage(_driver);
    }

    [Test]
    public void SuccessfulLoginTest()
    {
        _loginPage.LoginAs("testuser", "password123");

        // Проверка успешного входа
        Assert.IsTrue(_driver.Url.Contains("/home"));
    }

    [TearDown]
    public void TearDown()
    {
        _driver.Quit();
    }
}
```

---

## 6. Примеры преимуществ POM

1. **Поддерживаемость:**
   Если поменялся локатор кнопки `LoginButton`, меняем только в `LoginPage.cs`. Тесты остаются без изменений.

2. **Повторное использование:**
   Метод `LoginAs` можно использовать во всех тестах, где требуется авторизация.

3. **Читаемость:**
   Тесты читаются почти как сценарий пользователя:

```csharp
_loginPage.LoginAs("testuser", "password123");
Assert.IsTrue(_driver.Url.Contains("/home"));
```

---

## 7. Резюме

* POM – это паттерн, который **разделяет страницы и тесты**
* Каждая страница – отдельный класс с локаторами и методами
* Тесты используют методы классов страниц, что повышает **поддерживаемость и читаемость**
* Применение POM особенно важно для **крупных проектов и динамических сайтов**

---

## 8. Контрольные вопросы

1. Что такое Page Object Model и зачем его использовать?
2. Какова структура проекта с POM?
3. Какие элементы включаются в Page класс?
4. Как повторное использование методов в POM помогает поддерживать тесты?
5. Приведите пример метода Page класса и использования его в тесте.
6. Что произойдет, если локатор элемента изменится на странице и мы используем POM?
7. В чем отличие обычного теста без POM от теста с POM?

