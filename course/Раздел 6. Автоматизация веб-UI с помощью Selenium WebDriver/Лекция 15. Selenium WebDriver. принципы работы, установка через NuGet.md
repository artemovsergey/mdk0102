# Лекция 15. Selenium WebDriver. Принципы работы, установка через NuGet

## Цель лекции

Познакомить студентов с основами работы с Selenium WebDriver, научить устанавливать и настраивать его в проектах .NET, рассмотреть принципы автоматизации браузеров, и показать практические примеры использования.

---

## План лекции

1. Введение в Selenium WebDriver
2. Принципы работы Selenium WebDriver
3. Установка Selenium WebDriver через NuGet в .NET проект
4. Основные команды WebDriver: открытие страницы, поиск элементов, взаимодействие
5. Примеры автоматизации простых сценариев
6. Резюме
7. Контрольные вопросы

---

## 1. Введение в Selenium WebDriver

**Selenium** — это набор инструментов для автоматизации веб-приложений. Основные возможности:

* Автоматизация тестов в браузерах (Chrome, Firefox, Edge и др.)
* Поддержка различных языков программирования: C#, Java, Python, JavaScript
* Используется для функционального тестирования веб-приложений

**Selenium WebDriver** — это компонент Selenium, который позволяет напрямую управлять браузером без необходимости ручного ввода. Он работает через драйвер конкретного браузера.

**Пример браузеров и драйверов:**

| Браузер | Драйвер      |
| ------- | ------------ |
| Chrome  | ChromeDriver |
| Firefox | GeckoDriver  |
| Edge    | EdgeDriver   |
| Safari  | SafariDriver |

---

## 2. Принципы работы Selenium WebDriver

Selenium WebDriver работает по принципу **клиент-сервер**:

1. WebDriver отправляет команды браузеру через драйвер (например, ChromeDriver.exe).
2. Браузер выполняет команды (открывает страницу, кликает, вводит текст).
3. WebDriver возвращает результаты выполнения команд в код теста.

**Простая схема работы:**

```
[Test code in C#] --> [WebDriver API] --> [Browser Driver] --> [Browser]
```

**Преимущества WebDriver:**

* Тесты запускаются в реальном браузере
* Поддержка всех современных браузеров
* Прямой доступ к DOM (Document Object Model)

---

## 3. Установка Selenium WebDriver через NuGet в .NET проект

1. Создаем проект **C# .NET Core / .NET Framework** в Visual Studio.
2. Открываем **NuGet Package Manager**:

   * ПКМ по проекту → Manage NuGet Packages
3. Находим пакет `Selenium.WebDriver` и устанавливаем его.
4. Для работы с конкретным браузером необходимо установить драйвер:

   * `Selenium.WebDriver.ChromeDriver` для Chrome
   * `Selenium.WebDriver.GeckoDriver` для Firefox

**Пример установки через NuGet Package Manager Console:**

```powershell
Install-Package Selenium.WebDriver
Install-Package Selenium.WebDriver.ChromeDriver
```

**Пример кода подключения:**

```csharp
using OpenQA.Selenium;
using OpenQA.Selenium.Chrome;

class Program
{
    static void Main(string[] args)
    {
        IWebDriver driver = new ChromeDriver(); // Инициализация Chrome
        driver.Navigate().GoToUrl("https://www.google.com");
        driver.Quit(); // Закрываем браузер
    }
}
```

---

## 4. Основные команды WebDriver

### 4.1 Открытие и закрытие браузера

```csharp
IWebDriver driver = new ChromeDriver();
driver.Navigate().GoToUrl("https://example.com"); // открыть URL
driver.Quit(); // закрыть браузер полностью
driver.Close(); // закрыть текущую вкладку
```

### 4.2 Поиск элементов

```csharp
IWebElement element = driver.FindElement(By.Id("username"));
IWebElement button = driver.FindElement(By.XPath("//button[text()='Login']"));
```

Методы поиска:

* `By.Id()`
* `By.Name()`
* `By.ClassName()`
* `By.XPath()`
* `By.CssSelector()`

### 4.3 Взаимодействие с элементами

```csharp
element.SendKeys("Тест");  // ввод текста
button.Click();            // клик по кнопке
string text = element.Text; // получить текст
```

### 4.4 Примеры ожиданий

```csharp
WebDriverWait wait = new WebDriverWait(driver, TimeSpan.FromSeconds(10));
IWebElement element = wait.Until(d => d.FindElement(By.Id("username")));
```

---

## 5. Примеры автоматизации простых сценариев

### Пример 1: Поиск на Google

```csharp
IWebDriver driver = new ChromeDriver();
driver.Navigate().GoToUrl("https://www.google.com");

IWebElement searchBox = driver.FindElement(By.Name("q"));
searchBox.SendKeys("Selenium WebDriver");
searchBox.SendKeys(Keys.Enter);

driver.Quit();
```

### Пример 2: Логин на сайте

```csharp
IWebDriver driver = new ChromeDriver();
driver.Navigate().GoToUrl("https://example.com/login");

driver.FindElement(By.Id("username")).SendKeys("testuser");
driver.FindElement(By.Id("password")).SendKeys("password123");
driver.FindElement(By.Id("loginButton")).Click();

driver.Quit();
```

---

## 6. Резюме

* Selenium WebDriver — инструмент для автоматизации браузеров.
* Работа WebDriver строится по принципу “клиент → драйвер → браузер”.
* В .NET WebDriver устанавливается через NuGet (`Selenium.WebDriver` и драйверы браузеров).
* Основные действия: открыть страницу, найти элемент, взаимодействовать, закрыть браузер.
* Практическая автоматизация требует правильного поиска элементов и использования ожиданий.

---

## 7. Контрольные вопросы

1. Что такое Selenium WebDriver и для чего он используется?
2. Какие браузеры поддерживаются Selenium WebDriver?
3. Как установить Selenium WebDriver в .NET проект через NuGet?
4. В чем разница между `driver.Close()` и `driver.Quit()`?
5. Какие методы поиска элементов вы знаете в Selenium?
6. Как сделать ожидание элемента перед взаимодействием с ним?
7. Приведите пример автоматизации поиска текста на сайте с помощью Selenium.