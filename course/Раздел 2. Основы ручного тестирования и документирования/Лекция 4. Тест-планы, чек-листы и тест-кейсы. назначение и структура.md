# Лекция 4. Тест-планы, чек-листы и тест-кейсы — фундамент качественного тестирования

**Цель:** Дать глубокое понимание трех ключевых артефактов тестирования, их взаимосвязи и практического применения в разработке на .NET.

### **План лекции:**

1.  **Введение: Зачем нам эта документация?**
2.  **Тест-план (Test Plan): Стратегия и тактика.**
    *   Что такое тест-план?
    *   Ключевые разделы тест-плана (на примере .NET приложения).
    *   Кто и когда его создает?
3.  **Чек-листы (Checklists): Гибкость и скорость.**
    *   Что такое чек-лист и когда его использовать?
    *   Структура хорошего чек-листа.
    *   Примеры для .NET (Code Review, Smoke Testing).
4.  **Тест-кейсы (Test Cases): Детализация и повторяемость.**
    *   Что такое тест-кейс?
    *   Атрибуты тест-кейса (на примере Azure DevOps/TFS).
    *   Виды тест-кейсов (Позитивные, Негативные, Исследовательские).
    *   Практический пример: Тест-кейс для метода .NET.
5.  **Взаимосвязь артефактов: Иерархия тестирования.**
6.  **Резюме: Ключевые выводы.**
7.  **Контрольные вопросы.**

---

### **1. Введение: Зачем нам эта документация?**

Представьте, что вы строите дом. Вы не начнете работу без архитектурного плана, списка необходимых материалов и пошаговых инструкций для бригады. В тестировании программного обеспечения — тест-план, чек-листы и тест-кейсы выполняют ровно те же функции.

*   **Тест-план** — это архитектурный план всего процесса тестирования.
*   **Чек-листы** — это списки "что не забыть сделать" (например, проверить перед сдачей дома).
*   **Тест-кейсы** — это пошаговые инструкции для проверки каждой розетки, окна и двери.

**Без этих артефактов:** процесс тестирования становится хаотичным, неполным, неповторимым и не поддающимся измерению.

### **2. Тест-план (Test Plan): Стратегия и тактика**

**Что это?**
Тест-план — это стратегический документ, который описывает **ЧТО, КАК, КОГДА и КЕМ** будет тестироваться. Это главный документ, руководствуясь которым, команда тестирования выполняет свою работу.

**Ключевые разделы тест-плана (на примере проекта "Интернет-магазин на .NET ASP.NET Core"):**

1.  **Введение и Объем (Introduction & Scope):**
    *   *Что тестируем?*: Основной функционал интернет-магазина: регистрация пользователя, поиск товаров, работа корзины, оформление заказа, интеграция с платежным шлюзом.
    *   *Что НЕ тестируем?*: Производительность на данном этапе (это будет в отдельном тест-плане), безопасность платежной системы (за это отвечает сторонний провайдер).

2.  **Подходы и Стратегия тестирования (Testing Approach & Strategy):**
    *   *Виды тестирования*:
        *   **Функциональное:** Проверка сценариев пользователя (Unit - xUnit/NUnit, Integration - ASP.NET Core Integration Tests, E2E - Selenium/SpecFlow).
        *   **Регрессионное:** Перед каждым релизом.
        *   **Дымовое (Smoke):** После каждого развертывания на тестовом стенде.
    *   **Критерии начала/окончания тестирования:**
        *   *Начало:* Готова стабильная сборка от разработчиков, развернутая на тестовой среде.
        *   *Окончание:* Все критические баги исправлены, процент успешных тест-кейсов > 95%.

3.  **Ресурсы и Расписание (Resources & Schedule):**
    *   *Люди:* 2 QA инженера, 1 автоматизатор.
    *   *Окружение:* Тестовый сервер (Windows Server + IIS + SQL Server), отдельная тестовая база данных.
    *   *Инструменты:* Visual Studio, xUnit, Selenium WebDriver, Azure DevOps для управления тест-кейсами и багами.
    *   *Сроки:* 2 недели на тестирование функционала после окончания спринта разработки.

4.  **Оценка рисков (Risk Assessment):**
    *   *Риск:* Срыв сроков из-за нестабильной сборки.
    *   *Митигация:* Регулярные коммуникации с тимлидом разработки, выделение "плавающего" времени в расписании.
    *   *Риск:* Неполная интеграция с платежным шлюзом в тестовом режиме.
    *   *Митигация:* Заблаговременно запросить тестовые доступы и документацию у провайдера.

**Кто и когда его создает?**
Тест-план обычно создает **Ведущий QA инженер или QA менеджер** в начале проекта или перед началом крупного этапа (например, нового спринта). Он согласовывается со всеми заинтересованными сторонами: менеджером проекта, архитектором, тимлидом разработки.

### **3. Чек-листы (Checklists): Гибкость и скорость**

**Что это и когда использовать?**
Чек-лист — это список пунктов, которые необходимо проверить, без строгой последовательности шагов. Это инструмент для **экспертного тестирования**, который напоминает о ключевых моментах, но не ограничивает тестировщика.

**Преимущества:** Быстрое создание, гибкость, идеально для регресса, дымового тестирования и областей, где важна не последовательность, а покрытие.

**Структура хорошего чек-листа:**
*   Четкий заголовок (Что проверяем?).
*   Пункты с однозначным результатом (Да/Нет/Не применимо).
*   Возможность добавления комментариев.

**Примеры для .NET:**

**Пример 1: Чек-лист для Code Review (выполняется разработчиком или QA)**
*   [ ] Код следует стандартам именования (C# coding conventions)?
*   [ ] Отсутствуют "магические числа" и строки (вынесены в константы или ресурсы)?
*   [ ] Все публичные методы и классы имеют XML-комментарии?
*   [ ] Проверка на `null` для входных параметров в публичных методах?
*   [ ] Нет утечек памяти или незакрытых соединений (например, `DbContext`, `SqlConnection`)?
*   [ ] Покрытие unit-тестами для нового бизнес-логического кода > 80%?

**Пример 2: Чек-лист для Дымового тестирования (Smoke Test) после деплоя ASP.NET Core приложения**
*   [ ] Приложение запускается без ошибок в IIS?
*   [ ] Главная страница загружается (статус 200 OK)?
*   [ ] Страница входа/регистрации доступна?
*   [ ] Подключение к базе данных работает (можно выполнить простой SELECT запрос)?
*   [ ] Критичный API-эндпоинт (например, `GET /api/products`) возвращает данные?
*   [ ] Статические файлы (css, js) загружаются корректно?

### **4. Тест-кейсы (Test Cases): Детализация и повторяемость**

**Что это?**
Тест-кейс — это детализированный набор шагов, условий и ожидаемых результатов, необходимых для проверки конкретной функции или ее части. Его главная цель — **обеспечить повторяемость** теста любым инженером.

**Атрибуты тест-кейса (в системах вроде Azure DevOps):**

*   **ID:** Уникальный идентификатор (например, `TC-API-001`).
*   **Title:** Краткое и понятное название (`Успешное создание товара через API`).
*   **Description:** Описание того, что проверяет этот кейс.
*   **Preconditions:** Условия, которые должны быть выполнены до начала теста (Пользователь с ролью "Администратор" авторизован в системе, API-ключ получен).
*   **Test Steps:** Последовательность шагов с ожидаемым результатом для каждого.
*   **Postconditions:** Состояние системы после выполнения теста (Созданный товар должен быть удален из БД).
*   **Priority:** (Высокий/Средний/Низкий).
*   **Related Requirement:** Связь с пользовательской историей или требованием.

**Виды тест-кейсов:**

*   **Позитивные:** Проверка, что система работает корректно с валидными данными.
*   **Негативные:** Проверка обработки ошибок и невалидных данных.
*   **Исследовательские:** Неформальное тестирование, основанное на опыте, без предопределенных шагов. Часто его результаты потом формализуются в тест-кейс.

**Практический пример: Тест-кейс для метода .NET**

**Предположим, у нас есть метод в сервисе:**
```csharp
public class ProductService
{
    public bool AddProduct(string name, decimal price)
    {
        if (string.IsNullOrWhiteSpace(name)) throw new ArgumentException("Product name cannot be empty.");
        if (price <= 0) throw new ArgumentException("Price must be greater than zero.");

        // ... логика добавления в базу данных ...
        return true;
    }
}
```

| ID | Title | Preconditions | Test Steps | Expected Result | Status (Pass/Fail) |
| :--- | :--- | :--- | :--- | :--- | :--- |
| **TC-PS-001** | **Успешное добавление товара с валидными данными** | Сервис `ProductService` инициализирован. | 1. Вызвать метод `AddProduct` с параметрами: `name="Test Product"`, `price=19.99`. | Метод возвращает `true`. Товар появляется в базе данных. | Pass |
| **TC-PS-002** | **Попытка добавления товара с пустым названием (Негативный)** | Сервис `ProductService` инициализирован. | 1. Вызвать метод `AddProduct` с параметрами: `name=""`, `price=19.99`. | Метод выбрасывает исключение `ArgumentException` с сообщением "Product name cannot be empty." | Pass |
| **TC-PS-003** | **Попытка добавления товара с отрицательной ценой (Негативный)** | Сервис `ProductService` инициализирован. | 1. Вызвать метод `AddProduct` с параметрами: `name="Test Product"`, `price=-5`. | Метод выбрасывает исключение `ArgumentException` с сообщением "Price must be greater than zero." | Pass |

### **5. Взаимосвязь артефактов: Иерархия тестирования**

Представьте эту взаимосвязь как пирамиду или дерево:

1.  **Тест-план** — это **корень и ствол**. Он определяет общее направление и объем.
2.  Из тест-плана вытекают **Чек-листы** и **Наборы тест-кейсов (Test Suites)**. Чек-листы покрывают области, где важна скорость и гибкость (например, "Чек-лист регрессионного тестирования корзины").
3.  **Тест-кейсы** — это **листья**. Они являются самой детализированной и атомарной частью процесса. Один чек-лист может ссылаться на десятки тест-кейсов, а может и не ссылаться вовсе, представляя собой самостоятельный инструмент проверки.

**Пример потока:**
*   **Тест-план** гласит: "Протестировать функционал корзины покупок".
*   Мы создаем **Чек-лист для корзины** с пунктами: "Добавление товара", "Изменение количества", "Удаление товара", "Применение промокода".
*   Для сложного пункта "Применение промокода" мы пишем несколько **Тест-кейсов** (проверка валидного промокода, невалидного, просроченного, промокода на сумму выше чека и т.д.).

### **6. Резюме: Ключевые выводы**

1.  **Тест-план** — это стратегический документ высшего уровня. Он отвечает на вопросы "Что?", "Как?" и "Когда?". Без него команда действует вслепую.
2.  **Чек-листы** — это тактический инструмент для экспертов. Они обеспечивают гибкость, скорость и помогают не упустить ключевые моменты, особенно в условиях ограниченного времени (регресс, дымовое тестирование).
3.  **Тест-кейсы** — это детальные, пошаговые инструкции. Они обеспечивают повторяемость, однозначность понимания и являются основой для тестовой автоматизации.
4.  Все три артефакта **не исключают, а дополняют друг друга**. Профессиональный QA-инженер владеет всеми инструментами и знает, когда применять каждый из них.
5.  В экосистеме .NET эти артефакты интегрируются с инструментами like Azure DevOps, что позволяет seamlessly связывать тест-кейсы с пользовательскими историями, багами и билдами.

### **7. Контрольные вопросы**

1.  Опишите ситуацию, в которой чек-лист будет предпочтительнее набора тест-кейсов. Обоснуйте свой ответ.
2.  Какие ключевые риски должен предусмотреть тест-план для проекта, связанного с миграцией старой базы данных ASP.NET приложения на новую версию SQL Server?
3.  На основе следующего описания метода, напишите **один позитивный** и **один негативный** тест-кейс.
    *   **Метод:** `public bool ValidateEmail(string email)`
    *   **Описание:** Метод проверяет, что переданная строка соответствует формату email-адреса. Возвращает `true` для валидного email и `false` — для невалидного.
4.  Как бы вы структурировали раздел "Подходы к тестированию" в тест-плане для большого enterprise-приложения на .NET, которое состоит из Web API (Backend) и мобильного приложения (Frontend)?
5.  Объясните, как тест-кейсы связаны с отчетами о дефектах (баг-репортами). Почему важно указывать ID тест-кейса при создании баг-репорта?